sources:
  my-pg-source:
    kind: postgres
    host: ${DB_HOST}
    port: ${DB_PORT}
    database: ${DB_NAME}
    user: ${DB_USER}
    password: ${DB_PASSWORD}

tools:
  add-user:
    kind: postgres-sql
    source: my-pg-source
    description: Adds a new user to the database.
    parameters:
      - name: name
        type: string
        description: Full name of the user.
      - name: email
        type: string
        description: Email address of the user.
      - name: relationship_type
        type: string
        description: Relationship type (family, friend, colleague, other).
      - name: company
        type: string
        description: Company name (optional).
      - name: college
        type: string
        description: College name (optional).
    statement: |
      INSERT INTO users (name, email, relationship_type, company, college, created_at)
      VALUES (
        $1,
        $2,
        $3,
        COALESCE($4, NULL),
        COALESCE($5, NULL),
        now()
      );

  add-transaction:
    kind: postgres-sql
    source: my-pg-source
    description: Adds a new transaction to the database.
    parameters:
      - name: amount
        type: string
        description: Transaction amount (decimal as string, e.g. "1250.75").
      - name: from_user
        type: string
        description: Name of the user who made the transaction.
    statement: |
      INSERT INTO transactions (amount, from_user, created_at)
      VALUES ($1::NUMERIC, $2::VARCHAR, now());

  get-transactions:
    kind: postgres-sql
    source: my-pg-source
    description: Retrieves transactions for a user.
    parameters:
      - name: from_user
        type: string
        description: Name of the user to filter by.
    statement: |
      SELECT *
      FROM transactions
      WHERE from_user = $1::VARCHAR
      ORDER BY created_at DESC;

  get-users:
    kind: postgres-sql
    source: my-pg-source
    description: Retrieves all users from the database.
    parameters: []
    statement: |
      SELECT *
      FROM users
      ORDER BY created_at DESC;

toolsets:
  expense_manager_tools:
    - add-user
    - add-transaction
    - get-transactions
    - get-users
